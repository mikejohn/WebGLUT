var Base64 = {};
Base64._code = ['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S',
                 'T','U','V','W','X','Y','Z','a','b','c','d','e','f','g','h','i','j','k','l',
                 'm','n','o','p','q','r','s','t','u','v','w','x','y','z','0','1','2','3','4',
                 '5','6','7','8','9','+','/','='];
Base64._map = [255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
                255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
                255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
                255, 255, 255, 255, 255, 255, 255,  62, 255, 255, 255,  63,
                52,  53,  54,  55,  56,  57,  58,  59,  60,  61, 255, 255,
                255, 254, 255, 255, 255,   0,   1,   2,   3,   4,   5,   6,
                7,   8,   9,  10,  11,  12,  13,  14,  15,  16,  17,  18,
                19,  20,  21,  22,  23,  24,  25, 255, 255, 255, 255, 255,
                255,  26,  27,  28,  29,  30,  31,  32,  33,  34,  35,  36,
                37,  38,  39,  40,  41,  42,  43,  44,  45,  46,  47,  48,
                49,  50,  51, 255, 255, 255, 255, 255, 255, 255, 255, 255,
                255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
                255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
                255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
                255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
                255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
                255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
                255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
                255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
                255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
                255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
                255, 255, 255, 255 ];
Base64.encode = function (input) {
    var len = input.length;
    var dst='', src = [];;
    var n = Math.floor(3*(len/3)), i;
    for(i=0;i<n;i+=3) {
        src[0] = input[i];
        src[1] = input[i+1];
        src[2] = input[i+2];
        dst+=Base64._code[(src[0]>>2)];
        dst+=Base64._code[((src[0] & 3) << 4) + (src[1] >> 4)];
        dst+=Base64._code[((src[1]&0xf)<<2)+(src[2]>>6)];
        dst+=Base64._code[src[2]&0x3f];
    }
    if(i<len) {
        var a = src[0],b = ((i+1)<len)?src[1]: 0,c=0;
        dst+=Base64._code[a >> 2];
        dst+=Base64._code[(a&3)<<4+(b>>4)];
        dst+=((i + 1) < len) ? Base64._code[((b & 0xf) << 2) + (c >> 6)] : '=';
        dst+='=';
    }
    return dst.toString();
};
Base64.decode = function (input) {
    var dst = [];
    var len = input.length;
    var g = 3;
    for(var i = 0,t = 0;i < len;++i) {
        var c = Base64._map[input.charCodeAt(i)];
        if(c == 255) continue;
        if(c == 254) {
            c = 0;
            --g;
        }
        t = (t << 6) | c;
        if((i&3)==3) {
            dst.push((t>>16)&255);
            if(g>1) dst.push((t>>8)&255);
            if(g>2) dst.push(t&255);
            t = 0;
        }
    }
    return dst;
};